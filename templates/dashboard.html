<!DOCTYPE html>
<html>
<head>
    <title>RAM NAVMI 2026</title>
</head>
<body>

<h2>ðŸš© RAM NAVMI 2026</h2>

{% if session.get("admin") %}
<a href="/logout">Logout</a>
{% else %}
<a href="/login">Login</a>
{% endif %}

<hr>

<h3>Total Cash: â‚¹{{ total_cash }}</h3>
<h3>Total Online: â‚¹{{ total_online }}</h3>
<h3>Total Expenses: â‚¹{{ total_expense }}</h3>
<h3>Net Balance: â‚¹{{ net }}</h3>

<hr>

{% if session.get("admin") %}
<h3>Add Collection</h3>
<form method="POST" action="/add_collection">
    <input name="name" placeholder="Name" required><br><br>
    <input name="amount" placeholder="Amount" required><br><br>
    <select name="mode" required>
        <option value="Cash">Cash</option>
        <option value="Online">Online</option>
    </select><br><br>
    <button type="submit">Add</button>
</form>

<h3>Add Expense</h3>
<form method="POST" action="/add_expense">
    <input name="name" placeholder="Name" required><br><br>
    <input name="amount" placeholder="Amount" required><br><br>
    <select name="mode" required>
        <option value="Cash">Cash</option>
        <option value="Online">Online</option>
    </select><br><br>
    <button type="submit">Add</button>
</form>

<hr>
{% endif %}

<!-- ðŸ” SEARCH BAR -->
<h3>Search Records</h3>
<input type="text" id="searchInput" placeholder="Search by name..." 
       onkeyup="searchTable()" 
       style="padding:6px; width:250px;">

<hr>

<h3>Collections</h3>
<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Name</th>
        <th>Amount</th>
        <th>Mode</th>
        {% if session.get("admin") %}
        <th>Action</th>
        {% endif %}
    </tr>

    {% for c in collections %}
    <tr>
        <td>{{ c.date.strftime("%d-%m-%Y") }}</td>
        <td>{{ c.name }}</td>
        <td>{{ c.amount }}</td>
        <td>{{ c.mode }}</td>
        {% if session.get("admin") %}
        <td>
            <a href="/edit/collection/{{c.id}}">Edit</a> |
            <a href="/delete/collection/{{c.id}}">Delete</a>
        </td>
        {% endif %}
    </tr>
    {% endfor %}
</table>

<br>

<h3>Expenses</h3>
<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Name</th>
        <th>Amount</th>
        <th>Mode</th>
        {% if session.get("admin") %}
        <th>Action</th>
        {% endif %}
    </tr>

    {% for e in expenses %}
    <tr>
        <td>{{ e.date.strftime("%d-%m-%Y") }}</td>
        <td>{{ e.name }}</td>
        <td>{{ e.amount }}</td>
        <td>{{ e.mode }}</td>
        {% if session.get("admin") %}
        <td>
            <a href="/edit/expense/{{e.id}}">Edit</a> |
            <a href="/delete/expense/{{e.id}}">Delete</a>
        </td>
        {% endif %}
    </tr>
    {% endfor %}
</table>

<!-- ðŸ”¥ SEARCH SCRIPT -->
<script>
function searchTable() {
    let input = document.getElementById("searchInput").value.toLowerCase();
    let tables = document.querySelectorAll("table");

    tables.forEach(table => {
        let rows = table.getElementsByTagName("tr");

        for (let i = 1; i < rows.length; i++) {
            let text = rows[i].innerText.toLowerCase();
            rows[i].style.display = text.includes(input) ? "" : "none";
        }
    });
}
</script>

</body>
</html>
